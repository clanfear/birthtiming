
# Set working directory
# setwd()
library(dplyr)
library(tidyr)

education <- read.table('./inst/data/raw_data/education/educ_survyear_79_12.dat', sep=' ')
names(education) <- c('C0000100',
  'C0000200',
  'C0005300',
  'C0005400',
  'C0005700',
  'C0053502',
  'C0054101',
  'C0055101',
  'C0057501',
  'C0058101',
  'C0058701',
  'C0059301',
  'C0059901',
  'C0061133',
  'C0061134',
  'C0061135',
  'C0061136',
  'C0061137',
  'C0061138',
  'C0061139',
  'C0061140',
  'C0061141',
  'C0061142',
  'C0061143',
  'C0061144',
  'C0061145',
  'C0061146',
  'C3602401',
  'C3982401',
  'C5526300',
  'C5802600',
  'Y2267000')


# Handle missing values

education[education == -1] = NA  # Refused
education[education == -2] = NA  # Dont know
education[education == -3] = NA  # Invalid missing
education[education == -7] = NA  # Missing


# If there are values not categorized they will be represented as NA
factor_vars <- function(data){
  data$C0005300 <- factor(data$C0005300,
    levels=c(1.0,2.0,3.0),
    labels=c("HISPANIC",
      "BLACK",
      "NON-BLACK, NON-HISPANIC"))
  data$C0005400 <- factor(data$C0005400,
    levels=c(1.0,2.0),
    labels=c("MALE",
      "FEMALE"))
  data$C0053502 <- factor(data$C0053502,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0054101 <- factor(data$C0054101,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0055101 <- factor(data$C0055101,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0057501 <- factor(data$C0057501,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0058101 <- factor(data$C0058101,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0058701 <- factor(data$C0058701,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0059301 <- factor(data$C0059301,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0059901 <- factor(data$C0059901,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061133 <- factor(data$C0061133,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061134 <- factor(data$C0061134,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061135 <- factor(data$C0061135,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061136 <- factor(data$C0061136,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061137 <- factor(data$C0061137,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061138 <- factor(data$C0061138,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061139 <- factor(data$C0061139,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061140 <- factor(data$C0061140,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061141 <- factor(data$C0061141,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061142 <- factor(data$C0061142,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061143 <- factor(data$C0061143,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061144 <- factor(data$C0061144,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061145 <- factor(data$C0061145,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C0061146 <- factor(data$C0061146,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C3602401 <- factor(data$C3602401,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C3982401 <- factor(data$C3982401,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C5526300 <- factor(data$C5526300,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
  data$C5802600 <- factor(data$C5802600,
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YR COL",
      "2ND YR COL",
      "3RD YR COL",
      "4TH YR COL",
      "5TH YR COL",
      "6TH YR COL",
      "7TH YR COL",
      "8TH YR COL OR MORE",
      "UNGRADED"))
 return(data)
}
education <- factor_vars(education)
# Use qnames rather than rnums

  names(education) <- c("child_id",
    "mother_id",
    "RACE",
    "SEX",
    "YOB",
    "highest_grade_1979",
    "highest_grade_1980",
    "highest_grade_1981",
    "highest_grade_1982",
    "highest_grade_1983",
    "highest_grade_1984",
    "highest_grade_1985",
    "highest_grade_1986",
    "highest_grade_1987",
    "highest_grade_1988",
    "highest_grade_1989",
    "highest_grade_1990",
    "highest_grade_1991",
    "highest_grade_1992",
    "highest_grade_1993",
    "highest_grade_1994",
    "highest_grade_1996",
    "highest_grade_1998",
    "highest_grade_2000",
    "highest_grade_2002",
    "highest_grade_2004",
    "highest_grade_2006",
    "highest_grade_2008",
    "highest_grade_2010",
    "highest_grade_2012",
    "highest_grade_2014",
    "VERSION_R26_XRND")

education <- education %>%
  select(-RACE, -SEX, -YOB, -VERSION_R26_XRND)


education <- education %>%
  gather(key="year", value="highest_grade", starts_with("highest_grade")) %>%
  mutate(year=str_extract(year, "[0-9]*$")) %>% arrange(mother_id, child_id, year)

save(education, file="./inst/data/raw_data/education.RData")
